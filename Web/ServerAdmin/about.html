<!-- #include file="header.inc" -->

<div id="content">
<dl>
    <dt>Engine Version</dt>
    <dd><%engine.version%></dd>
    <dt>Minimum Network Version</dt>
    <dd><%engine.netversion%></dd>
    <dt>Game Version</dt>
    <dd><%game.version%></dd>
    
    <dt>WebAdmin Version</dt>
    <dd>v<%build.version%></dd>
    <dt>WebAdmin Timestamp</dt>
    <dd><%build.timestamp%></dd>
    <dt>WebAdmin Address</dt>
    <dd><%webadmin.address%></dd>
    <dt>Authentication Method</dt>
    <dd><%webadmin.authmethod%></dd>
    
    <dt>Admin Username</dt>
    <dd><%admin.name%></dd>
    <!--<dt>Remember Authentication</dt>
    <dd><%client.remember%></dd>-->
    <dt>Remote Address</dt>
    <dd><%client.address%></dd>        
</dl>

<dl id="webadmininfo">
    <dt>UT3 WebAdmin Information</dt>
    <dd><a href="http://ut3webadmin.elmuerte.com">Homepage</a></dd>
    <dd><a href="http://ut3webadmin.elmuerte.com/bugtracker">Bug tracker</a></dd>
</dl>
</div>

<script type="text/javascript">
//<![CDATA[
$(document).ready(function(){
    $('#webadmininfo').append('<dd id="versioncheck"><button title="Retrieve information about the latest version of the UT3 WebAdmin.">Version check</button></dd>');
    $('#versioncheck button').click(function(){
        $('#versioncheck').remove();
        $(document).append('<script type="text/javascript" src="http://ut3webadmin.elmuerte.com/releases.php?versioncheck=js2"><'+'/script>');     
    });
});

function versionUpdate(versionData) {
    if (!versionData.version) {
        $('#versioncheck').append('<em>Error retrieving version information</em>');
        return;
    }
    var type = "info";
    var reqInfo = "";
    if (versionData.mingamever) {
        reqInfo = "<br />Requires UT3 version "+versionData.mingamever+" (engine version: "+versionData.minengine+")";
        if (versionCompare('<%build.version%>', versionData.mingamever) != 0) {
            type = "warn";
        }
    }
    if (versionData.minengine) {
        if (parseInt('<%engine.version%>') < parseInt(versionData.minengine)) {
            reqInfo = reqInfo + "<br />You need to update the game to a new version to use this patch.";
            type = "error";
        }
    }
    $('#messages').append('<div class="message '+type+'"><b>Latest version:</b> '
        + '<em>v'+versionData.version+' &ndash; '+versionData.date+'</em> '
        +reqInfo
        + '<br /><a rel="external" href="'+versionData.url+'">Download</a></div>');
}

/**
 * Compare versions. Returns 0 when the versions are equal
 */ 
function versionCompare(v1, v2) {
    var p1 = v1.split(".");
    var p2 = v2.split(".");
    for (var i = 0; i < p1.length; i++)
    {
        if (p2.length <= i) return 1;
        var diff = parseInt(p1[i]) - parseInt(p2[i]);
        if (diff != 0) return diff;
    }
    return 0;
}

if ( window.addEventListener ) {
    var kkeys = [], konami = "38,38,40,40,37,39,37,39,66,65";
    window.addEventListener("keydown", function(e){
        kkeys.push( e.keyCode );
        if ( kkeys.toString().indexOf( konami ) >= 0 )
        window.location = "<%webadmin.path%>/"+unescape('%63%72%65%64%69%74%73');
    }, true);
}

//]]>
</script>

<!-- #include file="navigation.inc" -->
<!-- #include file="footer.inc" -->
